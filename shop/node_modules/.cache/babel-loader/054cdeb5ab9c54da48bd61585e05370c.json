{"ast":null,"code":"import _objectSpread from\"/var/www/html/check/javascript-shop/client.v1/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/var/www/html/check/javascript-shop/client.v1/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState,useEffect}from'react';import{AppContext}from'./AppContext.js';import{fetchBasket,increment,decrement,remove}from'../http/basketAPI.js';import{Table,Spinner,Button}from'react-bootstrap';import{useNavigate}from'react-router-dom';import BasketItem from'./BasketItem.js';import{observer}from'mobx-react-lite';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var BasketList=observer(function(){var _useContext=useContext(AppContext),basket=_useContext.basket;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),fetching=_useState2[0],setFetching=_useState2[1];var navigate=useNavigate();var handleIncrement=function handleIncrement(id){setFetching(true);increment(id).then(function(data){return basket.products=data.products;}).finally(function(){return setFetching(false);});};var handleDecrement=function handleDecrement(id){setFetching(true);decrement(id).then(function(data){return basket.products=data.products;}).finally(function(){return setFetching(false);});};var handleRemove=function handleRemove(id){setFetching(true);remove(id).then(function(data){return basket.products=data.products;}).finally(function(){return setFetching(false);});};useEffect(function(){fetchBasket().then(function(data){return basket.products=data.products;}).finally(function(){return setFetching(false);});},[]);if(fetching){return/*#__PURE__*/_jsx(Spinner,{animation:\"border\"});}return/*#__PURE__*/_jsx(_Fragment,{children:basket.count?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Table,{bordered:true,hover:true,size:\"sm\",className:\"mt-3\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u041D\\u0430\\u0438\\u043C\\u0435\\u043D\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0426\\u0435\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0421\\u0443\\u043C\\u043C\\u0430\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[basket.products.map(function(item){return/*#__PURE__*/_jsx(BasketItem,_objectSpread({increment:handleIncrement,decrement:handleDecrement,remove:handleRemove},item),item.id);}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{colSpan:\"3\",children:\"\\u0418\\u0442\\u043E\\u0433\\u043E\"}),/*#__PURE__*/_jsx(\"th\",{children:basket.sum}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0440\\u0443\\u0431.\"})]})]})]}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return navigate('/checkout');},children:\"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"})]}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u0412\\u0430\\u0448\\u0430 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \\u043F\\u0443\\u0441\\u0442\\u0430\"})});});export default BasketList;","map":{"version":3,"sources":["/var/www/html/check/javascript-shop/client.v1/src/components/BasketList.js"],"names":["useContext","useState","useEffect","AppContext","fetchBasket","increment","decrement","remove","Table","Spinner","Button","useNavigate","BasketItem","observer","BasketList","basket","fetching","setFetching","navigate","handleIncrement","id","then","data","products","finally","handleDecrement","handleRemove","count","map","item","sum"],"mappings":"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","sourcesContent":["import { useContext, useState, useEffect } from 'react'\nimport { AppContext } from './AppContext.js'\nimport { fetchBasket, increment, decrement, remove } from '../http/basketAPI.js'\nimport { Table, Spinner, Button } from 'react-bootstrap'\nimport { useNavigate } from 'react-router-dom'\nimport BasketItem from './BasketItem.js'\nimport { observer } from 'mobx-react-lite'\n\nconst BasketList = observer(() => {\n    const { basket } = useContext(AppContext)\n    const [fetching, setFetching] = useState(true)\n\n    const navigate = useNavigate()\n\n    const handleIncrement = (id) => {\n        setFetching(true)\n        increment(id)\n            .then(\n                data => basket.products = data.products\n            )\n            .finally(\n                () => setFetching(false)\n            )\n    }\n\n    const handleDecrement = (id) => {\n        setFetching(true)\n        decrement(id)\n            .then(\n                data => basket.products = data.products\n            )\n            .finally(\n                () => setFetching(false)\n            )\n    }\n\n    const handleRemove = (id) => {\n        setFetching(true)\n        remove(id)\n            .then(\n                data => basket.products = data.products\n            )\n            .finally(\n                () => setFetching(false)\n            )\n    }\n\n    useEffect(() => {\n        fetchBasket()\n            .then(\n                data => basket.products = data.products\n            )\n            .finally(\n                () => setFetching(false)\n            )\n    }, [])\n\n    if (fetching) {\n        return <Spinner animation=\"border\" />\n    }\n\n    return (\n        <>\n            {basket.count ? (\n                <>\n                    <Table bordered hover size=\"sm\" className=\"mt-3\">\n                        <thead>\n                            <tr>\n                                <th>Наименование</th>\n                                <th>Количество</th>\n                                <th>Цена</th>\n                                <th>Сумма</th>\n                                <th>Удалить</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {basket.products.map(item => \n                                <BasketItem\n                                    key={item.id}\n                                    increment={handleIncrement}\n                                    decrement={handleDecrement}\n                                    remove={handleRemove}\n                                    {...item}\n                                />\n                            )}\n                            <tr>\n                                <th colSpan=\"3\">Итого</th>\n                                <th>{basket.sum}</th>\n                                <th>руб.</th>\n                            </tr>\n                        </tbody>\n                    </Table>\n                    <Button onClick={() => navigate('/checkout')}>Оформить заказ</Button>\n                </>\n            ) : (\n                <p>Ваша корзина пуста</p>\n            )}\n        </>\n    )\n})\n\nexport default BasketList"]},"metadata":{},"sourceType":"module"}