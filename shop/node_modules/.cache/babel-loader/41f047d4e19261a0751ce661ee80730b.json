{"ast":null,"code":"import _slicedToArray from\"/var/www/html/check/javascript-shop/client.v1/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{fetchCategories,deleteCategory}from'../http/catalogAPI.js';import{Button,Container,Spinner,Table}from'react-bootstrap';import CreateCategory from'../components/CreateCategory.js';import UpdateCategory from'../components/UpdateCategory.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AdminCategories=function AdminCategories(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),categories=_useState2[0],setCategories=_useState2[1];// список загруженных категорий\nvar _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),fetching=_useState4[0],setFetching=_useState4[1];// загрузка списка категорий с сервера\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),createShow=_useState6[0],setCreateShow=_useState6[1];// модальное окно создания категории\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateShow=_useState8[0],setUpdateShow=_useState8[1];// модальное окно редактирования\n// для обновления списка после добавления, редактирования, удаления — изменяем состояние\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),change=_useState10[0],setChange=_useState10[1];// id категории, которую будем редактировать — для передачи в <UpdateCategory id={…} />\nvar _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),category=_useState12[0],setCategory=_useState12[1];var handleUpdateClick=function handleUpdateClick(id){setCategory(id);setUpdateShow(true);};var handleDeleteClick=function handleDeleteClick(id){deleteCategory(id).then(function(data){setChange(!change);alert(\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F \\xAB\".concat(data.name,\"\\xBB \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\\u0430\"));}).catch(function(error){return alert(error.response.data.message);});};useEffect(function(){fetchCategories().then(function(data){return setCategories(data);}).finally(function(){return setFetching(false);});},[change]);if(fetching){return/*#__PURE__*/_jsx(Spinner,{animation:\"border\"});}return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setCreateShow(true);},children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044E\"}),/*#__PURE__*/_jsx(CreateCategory,{show:createShow,setShow:setCreateShow,setChange:setChange}),/*#__PURE__*/_jsx(UpdateCategory,{id:category,show:updateShow,setShow:setUpdateShow,setChange:setChange}),categories.length>0?/*#__PURE__*/_jsxs(Table,{bordered:true,hover:true,size:\"sm\",className:\"mt-3\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:categories.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"success\",size:\"sm\",onClick:function onClick(){return handleUpdateClick(item.id);},children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"danger\",size:\"sm\",onClick:function onClick(){return handleDeleteClick(item.id);},children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})})]},item.id);})})]}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u0421\\u043F\\u0438\\u0441\\u043E\\u043A \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0439 \\u043F\\u0443\\u0441\\u0442\\u043E\\u0439\"})]});};export default AdminCategories;","map":{"version":3,"sources":["/var/www/html/check/javascript-shop/client.v1/src/pages/AdminCategories.js"],"names":["useState","useEffect","fetchCategories","deleteCategory","Button","Container","Spinner","Table","CreateCategory","UpdateCategory","AdminCategories","categories","setCategories","fetching","setFetching","createShow","setCreateShow","updateShow","setUpdateShow","change","setChange","category","setCategory","handleUpdateClick","id","handleDeleteClick","then","data","alert","name","catch","error","response","message","finally","length","map","item"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport { fetchCategories, deleteCategory } from '../http/catalogAPI.js'\nimport { Button, Container, Spinner, Table } from 'react-bootstrap'\nimport CreateCategory from '../components/CreateCategory.js'\nimport UpdateCategory from '../components/UpdateCategory.js'\n\nconst AdminCategories = () => {\n    const [categories, setCategories] = useState(null) // список загруженных категорий\n    const [fetching, setFetching] = useState(true) // загрузка списка категорий с сервера\n    const [createShow, setCreateShow] = useState(false) // модальное окно создания категории\n    const [updateShow, setUpdateShow] = useState(false) // модальное окно редактирования\n    // для обновления списка после добавления, редактирования, удаления — изменяем состояние\n    const [change, setChange] = useState(false)\n    // id категории, которую будем редактировать — для передачи в <UpdateCategory id={…} />\n    const [category, setCategory] = useState(null)\n\n    const handleUpdateClick = (id) => {\n        setCategory(id)\n        setUpdateShow(true)\n    }\n\n    const handleDeleteClick = (id) => {\n        deleteCategory(id)\n            .then(\n                data => {\n                    setChange(!change)\n                    alert(`Категория «${data.name}» удалена`)\n                }\n            )\n            .catch(\n                error => alert(error.response.data.message)\n            )\n    }\n\n    useEffect(() => {\n        fetchCategories()\n            .then(\n                data => setCategories(data)\n            )\n            .finally(\n                () => setFetching(false)\n            )\n    }, [change])\n\n    if (fetching) {\n        return <Spinner animation=\"border\" />\n    }\n\n    return (\n        <Container>\n            <h1>Категории</h1>\n            <Button onClick={() => setCreateShow(true)}>Создать категорию</Button>\n            <CreateCategory show={createShow} setShow={setCreateShow} setChange={setChange} />\n            <UpdateCategory id={category} show={updateShow} setShow={setUpdateShow} setChange={setChange} />\n            {categories.length > 0 ? (\n                <Table bordered hover size=\"sm\" className=\"mt-3\">\n                    <thead>\n                        <tr>\n                            <th>Название</th>\n                            <th>Редактировать</th>\n                            <th>Удалить</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {categories.map(item => \n                            <tr key={item.id}>\n                                <td>{item.name}</td>\n                                <td>\n                                    <Button variant=\"success\" size=\"sm\" onClick={() => handleUpdateClick(item.id)}>\n                                        Редактировать\n                                    </Button>\n                                </td>\n                                <td>\n                                    <Button variant=\"danger\" size=\"sm\" onClick={() => handleDeleteClick(item.id)}>\n                                        Удалить\n                                    </Button>\n                                </td>\n                            </tr>\n                        )}\n                    </tbody>\n                </Table>\n            ) : (\n                <p>Список категорий пустой</p>\n            )}\n        </Container>\n    )\n}\n\nexport default AdminCategories"]},"metadata":{},"sourceType":"module"}